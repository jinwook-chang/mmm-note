
### 3.1. 데이터 준비: 어떤 데이터가 필요한가?

Robyn을 사용하기 위한 가장 중요하고 시간이 많이 소요될 수 있는 단계는 바로 **데이터 준비**입니다. Robyn은 특정 형식의 시계열 데이터를 필요로 합니다.

* **필수 데이터:**
    * **결과 변수 (Outcome Variable):** 분석하고자 하는 핵심 성과 지표입니다. (예: 주별 `Revenue` 또는 `Conversions`)
    * **날짜 변수 (Date Variable):** 데이터의 시간 기준입니다. (예: `2023-01-01`, `2023-01-08`... 각 행이 날짜 또는 주차를 나타냄)
    * **유료 미디어 변수 (Paid Media Variables):** 각 마케팅 채널에 대한 데이터입니다. 채널별 **지출액(Spend)** 또는 **노출수(Impression)**를 사용합니다. Robyn은 일반적으로 **지출액 사용을 권장**합니다. (예: `tv_S` (TV 광고 지출), `facebook_S` (페이스북 광고 지출), `search_S` (검색 광고 지출))
    * *(선택적) 유기적 미디어 변수 (Organic Media Variables):* 광고비 지출 없이 발생하는 채널의 데이터입니다. (예: `seo_clicks` (자연 검색 클릭 수))

* **추가 권장 데이터:**
    * **외부 요인 변수 (Context Variables / Events):** 마케팅 외에 결과 변수에 영향을 줄 수 있는 모든 요인입니다. (예: `competitor_sales_B` (경쟁사 매출), `promotion_periods` (프로모션 기간 여부), `holidays` (공휴일 여부), `unemployment_rate` (실업률))
    * **Prophet 관련 변수:** Prophet 기능을 사용하여 추세, 계절성 등을 모델링하려면 관련 설정이 필요할 수 있습니다. (예: 데이터가 포함하는 `country` 정보)

* **데이터 형식 및 조건:**
    * 일반적으로 **CSV 파일** 형태로 준비합니다.
    * 데이터는 **일별(Daily)** 또는 **주별(Weekly)** 단위로 집계되어 있어야 합니다. (Robyn은 주별 데이터를 더 권장하는 경향이 있습니다.)
    * 모델의 안정성과 신뢰도를 위해 **최소 2년 이상의 데이터**를 권장합니다.
    * 데이터의 **일관성**과 **정확성**이 매우 중요합니다. (예: 모든 채널의 지출 데이터가 동일한 통화 및 기준으로 집계되었는지 확인)

### 3.2. Robyn 설정 및 모델 실행 (개념적 설명)

데이터가 준비되면, R 환경에서 Robyn 코드를 사용하여 모델링을 시작합니다.

1.  **Robyn 입력 설정 (`robyn_inputs()`):** 준비된 데이터를 R로 불러와서, 어떤 변수가 결과 변수인지, 날짜 변수인지, 각 마케팅 채널 변수인지 등을 Robyn에게 알려주는 단계입니다. 여기서 각 채널의 Adstock 타입(Geometric/Weibull) 등도 설정합니다.
2.  **하이퍼파라미터 범위 지정:** 각 마케팅 채널별 Adstock(효과 지속 기간 등)과 Saturation(S자 곡선의 형태 등)을 나타내는 하이퍼파라미터 값의 **탐색 범위**를 지정합니다. Robyn은 기본 범위를 제공하지만, 분석가는 비즈니스 지식이나 사전 경험을 바탕으로 이 범위를 조정할 수 있습니다. 예를 들어, "TV 광고 효과는 최소 4주에서 최대 12주까지 지속될 것 같다" 와 같이 범위를 설정하는 식입니다.
3.  **모델 실행 (`robyn_run()`):** 이 함수를 실행하면 Robyn이 본격적으로 모델링을 시작합니다. 설정된 하이퍼파라미터 범위 내에서 수많은(사용자가 설정한 `trials` 횟수만큼, 예를 들어 2000번) 모델 조합을 테스트하고, Nevergrad 알고리즘을 이용해 최적의 모델 후보들을 찾아냅니다. 이 과정은 컴퓨터 성능과 데이터 크기에 따라 몇 분에서 몇 시간 이상 소요될 수 있습니다.

### 3.3. 결과 해석: 주요 결과물 이해하기

모델 실행이 완료되면, Robyn은 분석 결과를 여러 파일과 시각화 자료로 생성하여 지정된 폴더에 저장합니다.

1.  **모델 선택 (`robyn_outputs()`):** `robyn_run()`이 끝난 후, 이 함수를 사용해 결과를 정리하고 시각화합니다. Robyn은 단 하나의 '정답' 모델을 제시하는 것이 아니라, **'파레토 최적(Pareto-optimal)'** 이라고 불리는 여러 개의 우수한 모델 후보군을 보여줍니다. 이는 모델의 오차율(Error)과 결과 분해의 분산(Decomposition variability)이라는 두 가지 기준 사이의 균형점을 나타냅니다. 분석가는 이 후보 모델들 중에서 다음 기준들을 종합적으로 고려하여 최종 모델을 선택합니다:
    * **낮은 오차율:** 모델이 실제 데이터를 얼마나 잘 설명하는가 (NRMSE, DECOMP.RSSD 지표 확인).
    * **합리적인 결과 분해:** 각 채널과 Base(기저)의 기여도 비율이 비즈니스 상식에 부합하는가.
    * **타당한 하이퍼파라미터 값:** Adstock과 Saturation 곡선의 형태가 너무 비현실적이거나 이상하지 않은가 (예: 광고 효과가 비정상적으로 길게 지속되거나, 아주 적은 예산에서 이미 포화되는 곡선 등).
    * **안정적인 ROI:** 채널별 ROI가 비즈니스적으로 납득 가능한 범위 내에 있는가.
2.  **주요 결과물 확인:** 선택된 모델(또는 상위 후보 모델들)에 대해 다음과 같은 주요 결과물을 확인하고 해석합니다.
    * **기여도 차트 (Contribution Chart):** 전체 성과(매출 등)에서 각 마케팅 채널, 외부 요인, 그리고 Base(기저 효과)가 차지하는 비중을 시각적으로 보여줍니다. (예: 막대 그래프 형태)
    * **ROI (Return on Investment):** 각 마케팅 채널의 평균 ROI와 시간에 따른 ROI 변화 추이를 보여줍니다. 어느 채널이 가장 효율적인지 파악하는 데 사용됩니다.
    * **반응 곡선 (Response Curve):** 각 채널에 대한 지출(또는 노출) 수준을 늘릴 때 예상되는 성과(증분 매출)가 어떻게 변하는지를 S자 곡선 형태로 보여줍니다. 이 곡선을 통해 채널별 최적 지출 수준이나 포화점(더 이상 지출을 늘려도 효과가 미미해지는 지점)을 가늠할 수 있습니다.
    * **Adstock 효과 시각화:** 각 채널의 광고 효과가 시간에 따라 어떻게 감소하는지(지속 기간)를 시각적으로 보여줍니다.

### 3.4. 예산 최적화 기능 활용

Robyn은 분석된 모델을 바탕으로 미래의 예산 배분을 최적화하는 시뮬레이션 기능(`robyn_allocator()`)을 제공합니다.

* **현재 예산 배분 vs. 최적 예산 배분:** 현재 채널별 예산 배분 방식과 비교하여, 동일한 총 예산으로 최대 성과를 얻기 위한 최적의 예산 배분안을 제시해 줍니다.
* **시나리오 분석:** 또는, 특정 성과 목표(예: 매출 10% 상승)를 달성하기 위해 필요한 최소 총 예산과 채널별 배분안을 시뮬레이션해 볼 수도 있습니다.
* **결과 확인:** 최적화 결과는 보통 '현재(Initial)' 배분 대비 '최적(Optimal)' 배분 시 각 채널 예산과 예상 성과 변화를 보여주는 표나 차트 형태로 제공됩니다.

---
